# 第五章 网络层：控制平面

## 1.导论

### 1.1 本章目标：理解网络层控制平面的==工作原理==

1. 传统路由选择算法
2. SDN控制器
3. ICMP：Internet Control Message Protocol
4. 网络管理
5. 以及它们在互联网上的==实例和实现：==
   + OSPF, BGP, OpenFlow, ODL 和ONOS控制器,  ICMP, SNMP

### 1.2 网络层功能

==回顾：2个网络层功能：==

1. ==转发：==将分组从路由器的一个输入端口移到合适的输出端口（数据平面）
2. ==路由：==确定分组从源到目标的路径（控制平面）

==2种构建网络控制平面功能的方法：==

1. 每个路由器控制功能实现（传统）
2. 逻辑上集中的控制功能实现（SDN）

##　２.路由选择算法

### 2.1 路由(route)

1. 路由的概念

   + 路由:按照某种指标(传输延迟,所经过的站点数目等)找到一条从源节点到目标节点的较好路径

     + 较好路径: 按照某种指标较小的路径

     + 指标:站数, 延迟,费用,队列长度等, 或者是一些单纯指标的加权平均

     + 采用什么样的指标,表示网络使用者希望网络在什么方面表现突出,什 么指标网络使用者比较重视

   + 以==网络==为单位进行路由（路由信息通告+路由计算）

     + 网络为单位进行路由，路由信息传输、计算和匹配的代价低

     + 前提条件是：一个网络所有节点地址前缀相同，且物理上聚集

     + 路由就是：计算网络到其他网络如何走的问题

   + 网络到网络的路由=路由器-路由器之间的路由

     + 网络对应的路由器到其他网络对应的路由器的路由
     + 在一个网络中：路由器-主机之间的通信，链路层解决

     + 到了路由器就是到了这个网络

   + 路由选择算法：网络层软件的一部分，完成路由功能

2. 图抽象：边和路径的代价

   ![](https://gitee.com/xatu-han-chen/computer-network-learning/raw/1978f5a4e3a37c50b23249b30bf32b5f7ee273ca/%E4%B8%AD%E7%A7%91%E5%A4%A7%20%E9%83%91%E7%83%87/resource/5.2.1.png)

3. 最优化原则

   + 汇集树（sink tree)
     + 此节点到所有其他节点的最优路径形成的树
     + 路由选择算法就是为所有路由器==找到==并==使用==汇集树

4. 路由的原则

   + 正确性（correctness):算法必须是==正确==的和==完整==的，使分组一站一站接力，正确发向目标站；完整：目标所有的站地址，在路由表中都能找到相应的表项；没有处理不了的目标站地址；
   + 简单性(simplicity):算法在计算机上应简单：最优但复杂 的算法，时间上延迟很大，不实用，不应为了获取路由 信息增加很多的通信量；
   + 健壮性(robustness):算法应能适应==通信量==和==网络拓扑==的 变化：通信量变化，网络拓扑的变化算法能很快适应； 不向很拥挤的链路发数据，不向断了的链路发送数据；
   + 稳定性(stability)：产生的路由不应该摇摆
   + 公平性(fairness)：对每一个站点都公平
   + 最优性(optimality)：某一个指标的最优，时间上，费用 上，等指标，或综合指标；实际上，获取最优的结果代 价较高，可以是次优的

5. 路由算法分类

   ==全局或者局部路由信息？==

   全局：

   + 所有的路由器拥有完整的拓扑和边的代价的信息
   + “==link state==”算法

   分布式：

   + 路由器只知道与它有物理连接 关系的邻居路由器，和到相应 邻居路由器的代价值
   + 叠代地与邻居交换路由信息、 计算路由信息
   + “==distance vector=="算法

   ==静态或者动态的?==

   静态:(非自适应算法：不能适应网络拓扑和通信量的变化，路由表是事先计算好的)

   + 路由随时间变化缓慢

   动态:(自适应路由选择：能适应网络拓扑和通信量的变化)

   + 路由变化很快
     + 周期性更新
     + 根据链路代价的变化而变化