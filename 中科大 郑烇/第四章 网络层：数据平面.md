# 第四章 网络层：数据平面

## 1、导论



### 1.1 网络层：数据平面

1. ==本章目标：==
	+ 理解网络服务的基本原理，聚焦于其==数据平面==
	  + 网络服务模型
	  + 转发和路由
	  + 路由器工作原理
	  + 通用转发
	+ 互联网中网络层协议的实例和实现
2. 网络层服务
  + 在发送主机和接收主机对之间传送段（segment）
  + 在发送端将段封装到数据报中
  + 在接收端，将段上交给传输层实体
  + 网络层协议存在于==每一个==主机 和路由器
  + 路由器检查每一个经过它的IP数据报的头部
3. 网络层的关键功能

   ==网络层功能：==

    + 转发：将分组从路由器的输入接口转发到合适的输出接口
    + 路由：使用路由算法来决定分组从发送主机到目标接收主机的路径
      + 路由选择算法
      + 路由选择协议
      ​      ==路由的类比：==

    + 转发:通过单个路口的过程
    + 路由:从源到目的的路由路径规划过程

### 1.2 网络层：数据平面、控制平面

1. ==数据平面==
   + 本地，每个路由器功能
   + 决定从路由器输入端口到达的分组如何转发到 输出端口
   + 转发功能：
     + 传统方式：基于目标地址+转发表
     + SDN方式：基于多个字段+流表
2. ==控制平面==
   + 网络范围内的逻辑
   + 决定数据报如何在路由器之间路由，决定数据报从源到目标主机之间的端到端路径
   + 2个控制平面方法:
     + 传统的路由算法: 在路由器 中被实现
     + software-defined networking  (SDN): 在远程的服务器中 实现

### 1.3 网络层：控制平面

1. 传统方式：每一路由器(per-router)控制平面

   在每一个路由器中的单独路由器算法元件，在控制平面进行交互

   ![](https://gitee.com/xatu-han-chen/computer-network-learning/raw/2fd3923930894d98585754159109d85eb65203fa/%E4%B8%AD%E7%A7%91%E5%A4%A7%20%E9%83%91%E7%83%87/resource/4.1.1.png)

2. 传统方式：路由和转发的相互作用

   ![](https://gitee.com/xatu-han-chen/computer-network-learning/raw/2fd3923930894d98585754159109d85eb65203fa/%E4%B8%AD%E7%A7%91%E5%A4%A7%20%E9%83%91%E7%83%87/resource/4.1.2.png)

3. SDN方式：逻辑集中的控制平面

   一个不同的（通常是远程的）控制器与本地控制代理（CAs)

   ![](https://gitee.com/xatu-han-chen/computer-network-learning/raw/2fd3923930894d98585754159109d85eb65203fa/%E4%B8%AD%E7%A7%91%E5%A4%A7%20%E9%83%91%E7%83%87/resource/4.1.3.pngS)
   
4. 网络服务模型

   Q:从发送方主机到接收方主机传输数据报的“通道” ，网络提供什么样的服务模型？
   
   ==对于单个数据报的服务:==
   
   + 可靠传送
   + 延迟保证，如：少于 40ms的延迟
   
   ==对于数据报流的服务:==
   
   + 保序数据报传送
   + 保证流的最小带宽
   + 分组之间的延迟差
   
5. 连接建立
   
   + 在某些网络架构中是第三个重要的功能
     + ATM, frame relay, X.25
   + 在分组传输之前，在两个主机之间，在通过一些 路由器所构成的路径上建立一个网络层连接
     + 涉及到路由器
   + 网络层和传输层连接服务区别:
     + ==网络层：==在2个主机之间，涉及到路径上的一些路由器
     + ==传输层：==在2个进程之间，很可能只体现在端系统上 (TCP连接)
   
   
